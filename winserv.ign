{
  "ignition": {
    "version": "3.5.0"
  },
  "passwd": {
    "users": [
      {
        "name": "core",
        "passwordHash": "$y$j9T$SJtncZAjzZEIZ872/KmO20$u5gQgmu5oqX1pXoHuBuW0wJ.LCJNyn5SGAER/TJEuq7",
        "sshAuthorizedKeys": [
          "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICJkPnoiDN0YMNlP//5kjLStlNyqU305GrG/PJGyI6wh siparikh@gmail.com"
        ]
      },
      {
        "name": "jellyfin",
        "uid": 1001
      }
    ]
  },
  "storage": {
    "directories": [
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config",
        "user": {
          "name": "jellyfin"
        },
        "mode": 493
      },
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config/containers",
        "user": {
          "name": "jellyfin"
        },
        "mode": 493
      },
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config/containers/systemd",
        "user": {
          "name": "jellyfin"
        },
        "mode": 493
      },
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config/systemd",
        "user": {
          "name": "jellyfin"
        },
        "mode": 493
      },
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config/systemd/user",
        "user": {
          "name": "jellyfin"
        },
        "mode": 493
      },
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config/systemd/user/timers.target.wants",
        "user": {
          "name": "jellyfin"
        },
        "mode": 493
      }
    ],
    "files": [
      {
        "path": "/etc/hostname",
        "contents": {
          "compression": "",
          "source": "data:,winserv%0A"
        },
        "mode": 420
      },
      {
        "path": "/var/lib/systemd/linger/jellyfin",
        "mode": 420
      },
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config/containers/systemd/jellyfin.container",
        "user": {
          "name": "jellyfin"
        },
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/2SQQW/aQBCF7/Mr+ANgqqotWNpDW1SJqiCES3KwfBjWg5mw3nVmZ4n87yMnQBLl8t7TfKPR6JU7z1rBgqIV7pSDN3/Juf7AfrSimnFUkJxJYEuPiYXiKiSv8U8Qk0U5Z+2wA1D+Dl6RPUkFt7jGlszD5RosW2zI1MGeSCYcsiu4hdyhUlT4mTTsuhqVjFDDUaWHTdo7jsdNEDWz6fx7PkimtvtAfnz9Ns8HyVLdwS6SrAtzIurGXENBNglr/w/35BYcce/IqCSCu+DSu0/HNvgDN3n26p8x2iPl2Ytd4VsX+cUkAJRDd2ypgi1FRVGD7gn7CP+5pZC0GGYFWfNlNgUolz4qOlfBPXql+ldvajpgcjpRlIYUngMAAP//TUfavK0BAAA="
        },
        "mode": 420
      }
    ],
    "filesystems": [
      {
        "device": "/dev/disk/by-label/storage",
        "format": "btrfs",
        "mountOptions": [
          "subvol=media",
          "compress=zstd"
        ],
        "path": "/var/srv/media",
        "wipeFilesystem": false
      }
    ],
    "links": [
      {
        "group": {
          "name": "jellyfin"
        },
        "path": "/var/home/jellyfin/.config/systemd/user/timers.target.wants/podman-auto-update.timer",
        "user": {
          "name": "jellyfin"
        },
        "target": "/usr/lib/systemd/user/podman-auto-update.timer"
      }
    ]
  },
  "systemd": {
    "units": [
      {
        "contents": "# Generated by Butane\n[Unit]\nRequires=systemd-fsck@dev-disk-by\\x2dlabel-storage.service\nAfter=systemd-fsck@dev-disk-by\\x2dlabel-storage.service\n\n[Mount]\nWhere=/var/srv/media\nWhat=/dev/disk/by-label/storage\nType=btrfs\nOptions=subvol=media,compress=zstd\n\n[Install]\nRequiredBy=local-fs.target",
        "enabled": true,
        "name": "var-srv-media.mount"
      },
      {
        "contents": "[Unit]\nDescription=Open Jellyfin firewall ports\nAfter=firewalld.service\nRequires=firewalld.service\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=/usr/bin/firewall-cmd --permanent --add-port=8096/tcp\nExecStart=/usr/bin/firewall-cmd --permanent --add-port=7359/udp\nExecStart=/usr/bin/firewall-cmd --reload\n\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "jellyfin-firewall.service"
      }
    ]
  }
}
